<!DOCTYPE html>
<html class="no-js">
    <head>
        <!--link to latest jquery-->
        <script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="theme-color" content="#2ECC71">
        <meta name="description" content="A web based project overviewer">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="mobile-web-app-capable" content="yes"> <!--Allows for mobile app launch. -->
        <meta name="apple-mobile-web-app-cpable" content="yes">
        <!-- more scripts -->
        <script src="js/vendor/modernizr-2.6.2-respond-1.1.0.min.js"></script>
        <!--links to stylesheets-->
        <link rel="stylesheet" href="uikit-2.10.0/css/uikit.min.css" />
        <link rel="stylesheet" href="css/materialize.css"  media="screen,projection"/>
        <link rel="stylesheet" href="css/custom.css">
        <!-- Materialize -->
        <script type="text/javascript" src="js/vendor/materialize.js"></script>
        <!-- first of many custom js files -->
        <script src="js/custom.js" type="text/javascript"></script>
        <!-- Vex Modals -->
        <script src="js/vendor/vex/vex.combined.min.js"></script>
        <script>vex.defaultOptions.className = 'vex-theme-plain';</script>
        <link rel="stylesheet" href="css/vendor/vex/vex.css" />
        <link rel="stylesheet" href="css/vendor/vex/vex-theme-plain.css" />
        <!-- UI kit -->
        <script src="uikit-2.10.0/js/uikit.min.js" type="text/javascript"></script>
        <script src="js/colcards.js"></script>
        <script type="text/javascript">
            var logstat = localStorage.getItem("loggedin");
            if (logstat != null) {
                var user = localStorage.getItem("currentuser");
                var userobj = JSON.parse(user);
                var name = userobj["username"];
                var colorcode = userobj["columncolor"];
                var isadmin = userobj["isAdmin"];
                if (isadmin == 1){
                    var admin = true;
                } else {
                    var admin = false;
                }
            } else {
                window.location.href = "./login.html";
            }
            var colstring = localStorage.getItem("columns");
            var columndata = JSON.parse(colstring);
            var numcolumns = columndata.length;
            var cardstring = localStorage.getItem("cards");
            var carddata = JSON.parse(cardstring);
        </script>
        <!-- For the dates. -->
        <script type="text/javascript" src="js/vendor/moment.js"></script>
        <script type="text/javascript" src="js/helper.js"></script>
        <script type="text/javascript" src="js/formatcard.js"></script>
        <script type="text/javascript" src="js/addcard.js"></script>
        <title>Pace</title>
    </head>
    <body>
        <nav class="light-blue">
            <div class="nav-wrapper">
                <a href="#" class="brand-logo">LL's Pace</a>
                <ul id="nav-mobile" class="right side-nav">
                    <li><a href="#" id="username">username</a></li>
                    <li><a href="#" onclick="popupsettings();">Settings</a></li>
                    <li><a href="#" onclick="logout();">Logout</a></li>
                </ul>
                <a class="button-collapse" href="#" data-activates="nav-mobile"><i class="mdi-navigation-menu"></i></a>
            </div>
        </nav>
        <!-- Settings Modal -->
        <div id="settingsModal" class="modal">
            <div>
                <ul class="tabs" id="setting-tabs-heads">
                    <li class="tab"><a href="#accountSettings">Account</a></li>
                </ul>
                <!-- SETTINGS -->
                <ul id="settings-tabs">
                    <li id="accountSettings" class="tab-content panel white">
                        <div class="row">
                            <form class="col s12" >
                                <fieldset>
                                    <div class="row">
                                        <h1>Account Settings</h1>
                                        <h5>Set Username:</h5>
                                        <div class="panel input-field">
                                            <label class="uk-form-label">Name:</label>
                                            <input type="text" id="username-input">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <h5>Password Reset:</h5>
                                        <div class="input-field col s4">
                                            <label class="uk-form-label">Current Password:</label>
                                            <input type="password" id="oldpass">
                                        </div>
                                        <div class="input-field col s4">
                                            <label class="uk-form-label">New Password:</label>
                                            <input type="password" id="newpass">
                                        </div>
                                        <div class="input-field col s4">
                                            <label class="uk-form-label">Confirm New Password:</label>
                                            <input type="password" id="newpassconf">
                                        </div>
                                    </div>
                                    <div class="row">
                                        <h5>Color Scheme:</h5>
                                        <div class="panel input-field col s8 offset-s2">
                                            <select id="colorSelect" class="disabled"></select>
                                            <div class="colorBox"></div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <button type="button" id="general-settings-btn" class="uk-button-primary uk-button-large button">Save Changes</button>
                                    </div>
                                </fieldset>
                            </form>
                        </div>
                    </li>
                    <li id="adminSettings" class="tab-content panel white">
                        <div class="row">
                            <form class="col s12">
                                <fieldset>
                                    <div class="row">
                                        <h1>Admin Settings</h1>
                                        <div class="panel">
                                            <h5>Add Users:</h5>
                                            <br/>
                                            <div class="input-field col s6">
                                                <label>New User Email:</label>
                                                <input type="email" id="admin-add-email">
                                            </div>
                                            <div class="input-field col s2">
                                                <select id="admin-add-admin" class="disabled">
                                                    <option value="true">Is an Admin</option>
                                                    <option value="false">Is not an Admin</option>
                                                </select>
                                            </div>
                                            <div class="input-field col s4">
                                                <button type="button" id="admin-add-user" class="waves-effect waves-light btn">Add user</button>
                                            </div>
                                        </div>
                                    </div>
                                    <br/>
                                    <div class="row">
                                        <h5>Remove a User:</h5>
                                        <div class="input-field col s4">
                                            <label class="uk-form-label">User's Email:</label>
                                            <input type="email" id="admin-remove-email">
                                        </div>
                                        <div class="input-field col s4">
                                            <label class="uk-form-label">Confirm User's Email:</label>
                                            <input type="email" id="admin-remove-email-conf">
                                        </div>
                                        <div class="input-field col s4">
                                            <button type="button" id="admin-remove-user" class="waves-effect waves-light btn">Remove user</button>
                                        </div>
                                    </div>
                                    <br/>
                                    <div class="row">
                                        <h5>Add Column:</h5>
                                        <div class="input-field col s6">
                                            <label class="uk-form-label">Column Name:</label>
                                            <input type="text" id="admin-add-column-name">
                                        </div>
                                        <div class="input-field col s4">
                                            <h6>Column Order:</h6>
                                            <p class="range-field" id="range-parent"></p>
                                        </div>
                                        <div class="input-field col s2">
                                            <button type="button" id="admin-add-column" class="waves-effect waves-light btn">Add Column</button>
                                        </div>
                                    </div>
                                    </br>
                                    <div class="row panel input-field">
                                        <h5>Remove Column:</h5>
                                        <div class="col s6">
                                            <select id="admin-remove-column-name" class="disabled"></select>
                                        </div>
                                        <div class="col s3 offset-s1">
                                            <button type="button" id="admin-remove-column" class="waves-effect waves-light btn">Remove Column</button>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col s2 center">
                                            <button type="button" class="waves-effect waves-light btn amber" onclick="popupformatcard();" id="make-card-btn">Format Card</button>
                                        </div>
                                    </div>
                                </fieldset>
                            </form>
                        </div>
                    </li>                                      
                </ul>
                <a href="#" class="waves-effect btn modal-close">Close</a>
            </div>
            <!--end settings modal-->
        </div>
        <!--start columns -->
        <ul id = "columnslist"></ul>
        <a class="btn-floating waves-effect waves-light blue darken-4" id="addcard-btn" onclick="popupaddcard();"><i class="mdi-content-add"></i></a>
        
        
        <script type="text/javascript" src="js/editcard.js"></script>
        <script type="text/javascript" src="js/makecols.js"></script>
        <script type="text/javascript" src="js/renderer.js"></script>
        <script type="text/javascript" src="js/settings.js"></script>
        <script type="text/javascript">
            //settings
            if(admin){
                $("#setting-tabs-heads").append("<li class='tab'><a href='#adminSettings'>Admin</a></li>");
                $("#setting-tabs-heads").append("<li class='tab'><a href='#login-info'>Info</a></li>");
                $("#settings-tabs").append("<li id='login-info' class='tab-content panel white'><div class='panel'><p class='flow-text'>Initial password for new users is 'seamonkey'. Make sure users change password upon initial login.</p></div></li>");
            }
            
            //column order
            var rangeparent = document.getElementById("range-parent");
            var num = numcolumns+1;
            rangeparent.innerHTML = "<input type='range' id='admin-add-column-order' min='0' max='"+num+"'/>";
            
            //remove column
            var addedstring = "";
            for(i=0; i<columndata.length; i++){
                addedstring += "<option>"+columndata[i].columnname+"</option>";
            }
            var select = document.getElementById("admin-remove-column-name");
            select.innerHTML = addedstring;
            
            //end of document scripts
            var unelem = document.getElementById("username");
            unelem.innerHTML = name;

            function logout(){
                localStorage.removeItem("currentuser");
                localStorage.removeItem("loggedin");
                localStorage.removeItem("columns");
                localStorage.removeItem("cards");
                window.location.href = "./login.html";
            }
            function popupsettings(){
                //show the settings popup!
                $('#settingsModal').openModal();
            }
            //init of materialize.js features
            $( document ).ready(function() {
                $(".button-collapse").sideNav();
                $('.button-collapse').sideNav({menuWidth: 300, activationWidth: 100});
                $(".dropdown-button").dropdown();
                $('ul.tabs').tabs();
                $('.datepicker').pickadate();
            });
        </script>
    </body>
</html>
